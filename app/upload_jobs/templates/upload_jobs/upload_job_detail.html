{% extends "base.html" %}
{% load i18n %}
{% load django_htmx %}

{% block title %}{{ upload_job.title }} | {{ block.super }}{% endblock %}
{% block content %}
  <nav class="breadcrumbs">
    <p>
      <a class="breadcrumbs__link"
         href="{% url 'upload_jobs:index' %}">{% translate "Upload Jobs" %}</a> â–¸
      <a>{{ upload_job.title }}</a>
    </p>
  </nav>

  <h1 class="h1">{{ upload_job.title }}</h1>

  <ul>
    <li>
      {{ upload_job.created_at }}
    </li>
    <li>
      {% blocktranslate count counter=uploaded_files.count %}one file{% plural %}{{ counter }} files{% endblocktranslate %}
    </li>
  </ul>

  <form action="{% url 'upload_jobs:delete' upload_job.id %}" method="POST" class="form">
    {% csrf_token %}
    <button type="submit" class="form__button">
      {% translate "Delete" %}
    </button>
  </form>

  <table class="u-mt">
    <thead>
      <tr>
        <th>{% translate "Filename" %}</th>
        <th>{% translate "Type" %}</th>
        <th>{% translate "Size" %}</th>
        <th>{% translate "Created at" %}</th>
        <th>{% translate "Server checksum" %}</th>
        <th>{% translate "Client checksum" %}</th>
        <th></th>
      </tr>
    </thead>
    <tbody hx-confirm="{% translate 'Are you sure?' %}"
           hx-target="closest tr" hx-swap="outerHTML swap:250ms">
      {% for file in uploaded_files %}
        <tr>
          <td>
            {{ file.filename }}
          </td>
          <td>
            {{ file.media_type }}
          </td>
          <td>
            {{ file.size|filesizeformat }}
          </td>
          <td>
            {{ file.created_at|date:"SHORT_DATE_FORMAT" }}
          </td>
          <td>
            {{ file.checksum_server }}
          </td>
          <td>
            {{ file.checksum_client }}
          </td>
          <td>
            <button class="form__button"
                    hx-post="{% url 'uploaded_files:delete' file.id %}">
              {% translate "Delete" %}
            </button>
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% endblock content %}
{% block javascript %}
  {% include "htmx_csrf_token.html" %}
{% endblock javascript %}
